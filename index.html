<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Initiative Tracker</title>
    <!-- Google Fonts - Inter for primary text, Poppins for headings -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons CDN for sleek iconography -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="style.css">
    <!-- Favicon -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <!-- Vanta.js Background Element -->
    <div id="vanta-background"></div>

    <div class="container">
        <div class="header-section">
            <h1>D&D Initiative Tracker</h1>
            <div class="round-turn-display">
                <p>Round: <span id="currentRound">1</span></p>
                <p>Turn: <span id="currentTurn">None</span></p>
            </div>
        </div>

        <div class="main-content-grid">
            <!-- Left Column: Combatants List & Add/Import -->
            <div class="column combatants-section">
                <h2>Combatants</h2>
                <div class="combatants-list" id="combatantsList">
                    <!-- Combatants will be rendered here by JavaScript -->
                </div>
                <div class="button-group">
                    <button id="openPcModalBtn" class="button button-primary"><i data-lucide="user-plus"></i> Add PC</button>
                    <button id="openMonsterModalBtn" class="button button-secondary"><i data-lucide="skull"></i> Add Monster</button>
                </div>
                <div class="button-group">
                    <button id="clearAllBtn" class="button button-danger"><i data-lucide="trash-2"></i> Clear All</button>
                    <button id="clearMonstersBtn" class="button button-danger"><i data-lucide="skull"></i> Clear Monsters</button>
                </div>
                <div class="button-group">
                    <button id="startCombatBtn" class="button button-success"><i data-lucide="play"></i> Start Combat</button>
                    <button id="nextTurnBtn" class="button button-secondary"><i data-lucide="arrow-right"></i> Next Turn</button>
                    <button id="prevTurnBtn" class="button button-secondary"><i data-lucide="arrow-left"></i> Prev Turn</button>
                </div>
            </div>

            <!-- Right Column: Dice Roller & Monster Search -->
            <div class="column tools-section">
                <!-- Dice Roller -->
                <div class="dice-roller card">
                    <h3>Dice Roller</h3>
                    <div class="input-group">
                        <input type="text" id="diceNotation" placeholder="e.g., 1d20+5, 2d6" class="input-field">
                        <button id="rollDiceBtn" class="button button-primary"><i data-lucide="dice"></i> Roll</button>
                    </div>
                    <div class="common-rolls button-group">
                        <button class="button dice-shortcut" data-roll="1d4">1d4</button>
                        <button class="button dice-shortcut" data-roll="1d6">1d6</button>
                        <button class="button dice-shortcut" data-roll="1d8">1d8</button>
                        <button class="button dice-shortcut" data-roll="1d10">1d10</button>
                        <button class="button dice-shortcut" data-roll="1d12">1d12</button>
                        <button class="button dice-shortcut" data-roll="1d20">1d20</button>
                        <button class="button dice-shortcut" data-roll="1d100">1d100</button>
                    </div>
                    <p id="rollResult" class="message-text">Roll result: -</p>
                </div>

                <!-- Monster Search -->
                <div class="monster-search card">
                    <h3>Search Monsters (Premium Feature)</h3>
                    <div class="input-group" data-feature="premium">
                        <input type="text" id="monsterSearchInput" placeholder="Search by name" class="input-field">
                        <button id="monsterSearchBtn" class="button button-primary"><i data-lucide="search"></i> Search</button>
                    </div>
                    <div id="monsterSearchResults" class="search-results-list" data-feature="premium">
                        <!-- Search results will be displayed here -->
                    </div>
                    <p class="feature-locked-message" data-feature="premium">Unlock premium features to search monsters!</p>
                </div>

                <!-- Monthly Code Unlock Section -->
                <div class="feature-unlock-section card">
                    <h3>Unlock Premium Features</h3>
                    <p>Enter this month's special code to access exclusive tools.</p>
                    <div class="input-group">
                        <input type="text" id="monthlyCodeInput" placeholder="Enter monthly code" class="input-field">
                        <button id="unlockMonthlyCodeBtn" class="button button-primary">Unlock</button>
                    </div>
                    <p id="monthlyCodeMessage" class="message-text"></p>
                </div>

                <!-- Example Premium Content (will be hidden/disabled if not unlocked) -->
                <div class="card" data-feature="premium">
                    <h3>Exclusive Premium Content</h3>
                    <p>This content is only visible/active when premium features are unlocked!</p>
                    <button class="button button-success">Premium Button</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Modals (keep existing modals) -->

    <!-- Modal for PC Add/Edit -->
    <div id="modal-pc-add" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-pc-add"><i data-lucide="x"></i></span>
            <h2>Add New PC</h2>
            <form id="pcForm">
                <div class="form-group">
                    <label for="pcName">Name:</label>
                    <input type="text" id="pcName" required class="input-field">
                </div>
                <div class="form-group">
                    <label for="pcInitiative">Initiative:</label>
                    <input type="number" id="pcInitiative" required class="input-field">
                </div>
                <div class="form-group">
                    <label for="pcHP">HP:</label>
                    <input type="number" id="pcHP" class="input-field">
                </div>
                <div class="form-group">
                    <label for="pcAC">AC:</label>
                    <input type="number" id="pcAC" class="input-field">
                </div>
                <button type="submit" class="button button-success">Add PC</button>
            </form>
        </div>
    </div>

    <!-- Modal for Monster Add -->
    <div id="modal-monster-add" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-monster-add"><i data-lucide="x"></i></span>
            <h2>Add New Monster</h2>
            <form id="monsterForm">
                <div class="form-group">
                    <label for="monsterName">Name:</label>
                    <input type="text" id="monsterName" required class="input-field">
                </div>
                <div class="form-group">
                    <label for="monsterInitiative">Initiative:</label>
                    <input type="number" id="monsterInitiative" required class="input-field">
                </div>
                <div class="form-group">
                    <label for="monsterHP">HP:</label>
                    <input type="number" id="monsterHP" class="input-field">
                </div>
                <div class="form-group">
                    <label for="monsterAC">AC:</label>
                    <input type="number" id="monsterAC" class="input-field">
                </div>
                <button type="submit" class="button button-success">Add Monster</button>
            </form>
        </div>
    </div>

    <!-- Modal for Edit Combatant -->
    <div id="modal-edit-combatant" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-edit-combatant"><i data-lucide="x"></i></span>
            <h2>Edit Combatant</h2>
            <form id="editCombatantForm">
                <input type="hidden" id="editCombatantId">
                <div class="form-group">
                    <label for="editCombatantName">Name:</label>
                    <input type="text" id="editCombatantName" required class="input-field">
                </div>
                <div class="form-group">
                    <label for="editCombatantInitiative">Initiative:</label>
                    <input type="number" id="editCombatantInitiative" required class="input-field">
                </div>
                <div class="form-group">
                    <label for="editCombatantHP">HP:</label>
                    <input type="number" id="editCombatantHP" class="input-field">
                </div>
                <div class="form-group">
                    <label for="editCombatantAC">AC:</label>
                    <input type="number" id="editCombatantAC" class="input-field">
                </div>
                <div class="form-group">
                    <label for="editCombatantConditions">Conditions:</label>
                    <div id="editCombatantConditionsList" class="conditions-list">
                        <!-- Conditions will be displayed here -->
                    </div>
                    <button type="button" id="openAddConditionModalBtn" class="button button-secondary"><i data-lucide="plus"></i> Add Condition</button>
                </div>
                <button type="submit" class="button button-success">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Modal for Condition Description -->
    <div id="modal-condition-description" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-condition-description"><i data-lucide="x"></i></span>
            <h2 id="conditionDescriptionTitle"></h2>
            <p id="conditionDescriptionText"></p>
        </div>
    </div>

    <!-- Modal for Add Condition -->
    <div id="modal-add-condition" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-add-condition"><i data-lucide="x"></i></span>
            <h2>Add Condition</h2>
            <input type="hidden" id="addConditionCombatantId">
            <div class="form-group">
                <label for="conditionSelect">Select Condition:</label>
                <select id="conditionSelect" class="input-field">
                    <!-- Options will be populated by JavaScript -->
                </select>
            </div>
            <div class="form-group">
                <label for="conditionDuration">Duration (Rounds, optional):</label>
                <input type="number" id="conditionDuration" placeholder="e.g., 3" class="input-field">
            </div>
            <button id="addConditionBtn" class="button button-success">Add Condition</button>
        </div>
    </div>

    <!-- Modal for Clear Confirmation -->
    <div id="modal-clear-confirmation" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-clear-confirmation"><i data-lucide="x"></i></span>
            <h2 id="confirmationModalTitle"></h2>
            <p id="confirmationModalText"></p>
            <div class="button-group">
                <button id="confirmationModalConfirmBtn" class="button button-danger">Confirm</button>
                <button id="confirmationModalCancelBtn" class="button button-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Modal for Monster Full Details -->
    <div id="modal-monster-full-details" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-monster-full-details"><i data-lucide="x"></i></span>
            <h2 id="monsterDetailsName"></h2>
            <div id="monsterDetailsContent">
                <!-- Monster details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modal for Generic Messages -->
    <div id="modal-message" class="modal">
        <div class="modal-content card">
            <span class="close-button" data-modal="modal-message"><i data-lucide="x"></i></span>
            <h2 id="messageModalTitle"></h2>
            <p id="messageModalText"></p>
            <button id="messageModalCloseBtn" class="button button-primary">OK</button>
        </div>
    </div>


    <!-- Vanta.js Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.cells.min.js"></script>
    <script>
        // Initialize Vanta.js background
        VANTA.CELLS({
            el: "#vanta-background",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            scale: 1.00,
            color1: 0x1A1A1A, // Darker color
            color2: 0x303030 // Lighter dark color
        });
    </script>
    <script src="script.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>
